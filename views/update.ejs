<!DOCTYPE html>
<html lang="en">
<%- include('./partials/head.ejs') %>
<body>
    <%- include('./partials/nav.ejs') %>
    <div class="container">
        <% if(data) { %>
            <form action="/movie/update/<%= data._id %>" method="post" enctype="multipart/form-data">
                <div class="mb-3">
                    <label for="uploaded_file" class="form-label lbl-poster">
                        <img src="/uploads/<%= data.image %>" alt="movie poster" title="Open">
                    </label>
                    <input type="file" class="form-control" id="uploaded_file" name="uploaded_file" hidden /> 
                    <input type="text" class="form-control" name="img_path" id="img_path" value="<%= data.image %>" readonly>                  
                </div>
                <div class="mb-3">
                    <label for="m_title" class="form-label">Movie Title:</label>
                    <input type="text" class="form-control" id="title" name="title" value="<%= data.title %>" required>
                </div>
                <div class="mb-3">
                    <label for="author" class="form-label">Author Name:</label>
                    <input type="text" class="form-control" id="author" name="author" value="<%= data.author %>" required>
                </div>
                <div class="mb-3">
                    <label for="desc" class="form-label">Description:</label>
                    <textarea class="form-control" id="desc" name="desc" rows="3"><%= data.desc %></textarea>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <a href="/" class="text-decoration-none text-white">Back</a>
                    </button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        <% } %>
    </div>
    <script>
        $(() => {
            $('#uploaded_file').change(function(){
                const fullPath = $(this).val();
                const fileName = fullPath.split('\\').pop();  
                $('#img_path').val(fileName);
            });
        })
    </script>

    <%- include('./partials/footer.ejs') %>
</body>
</html>